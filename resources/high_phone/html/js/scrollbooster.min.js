!function(b,a){"object"==typeof exports&&"object"==typeof module?module.exports=a():"function"==typeof define&&define.amd?define("ScrollBooster",[],a):"object"==typeof exports?exports.ScrollBooster=a():b.ScrollBooster=a()}(this,function(){return function(b){var c={};function a(d){if(c[d])return c[d].exports;var e=c[d]={i:d,l:!1,exports:{}};return b[d].call(e.exports,e,e.exports,a),e.l=!0,e.exports}return a.m=b,a.c=c,a.d=function(b,c,d){a.o(b,c)||Object.defineProperty(b,c,{enumerable:!0,get:d})},a.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},a.t=function(b,c){if(1&c&&(b=a(b)),8&c||4&c&&"object"==typeof b&&b&&b.__esModule)return b;var d=Object.create(null);if(a.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:b}),2&c&&"string"!=typeof b)for(var e in b)a.d(d,e,(function(a){return b[a]}).bind(null,e));return d},a.n=function(c){var b=c&&c.__esModule?function(){return c.default}:function(){return c};return a.d(b,"a",b),b},a.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},a.p="",a(a.s=0)}([function(c,a,b){"use strict";function d(c,d){var a=Object.keys(c);if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(c);d&&(b=b.filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable})),a.push.apply(a,b)}return a}function e(c){for(var a=1;a<arguments.length;a++){var b=null!=arguments[a]?arguments[a]:{};a%2?d(Object(b),!0).forEach(function(a){f(c,a,b[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(c,Object.getOwnPropertyDescriptors(b)):d(Object(b)).forEach(function(a){Object.defineProperty(c,a,Object.getOwnPropertyDescriptor(b,a))})}return c}function f(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function g(d,c){for(var b=0;b<c.length;b++){var a=c[b];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(d,a.key,a)}}b.r(a),b.d(a,"default",function(){return h});var h=function(){var a,b,c;function d(){var b=arguments.length>0&& void 0!==arguments[0]?arguments[0]:{};!function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}(this,d);var c={content:b.viewport.children[0],direction:"all",pointerMode:"all",scrollMode:void 0,bounce:!0,bounceForce:.1,friction:.05,textSelection:!1,inputsFocus:!0,emulateScroll:!1,preventDefaultOnEmulateScroll:!1,preventPointerMoveDefault:!0,lockScrollOnDragDirection:!1,pointerDownPreventDefault:!0,dragDirectionTolerance:40,onPointerDown:function(){},onPointerUp:function(){},onPointerMove:function(){},onClick:function(){},onUpdate:function(){},onWheel:function(){},shouldScroll:function(){return!0}};if(this.props=e(e({},c),b),this.props.viewport&&this.props.viewport instanceof Element){if(this.props.content){this.isDragging=!1,this.isTargetScroll=!1,this.isScrolling=!1,this.isRunning=!1;var a={x:0,y:0};this.position=e({},a),this.velocity=e({},a),this.dragStartPosition=e({},a),this.dragOffset=e({},a),this.clientOffset=e({},a),this.dragPosition=e({},a),this.targetPosition=e({},a),this.scrollOffset=e({},a),this.rafID=null,this.events={},this.updateMetrics(),this.handleEvents()}else console.error("ScrollBooster init error: Viewport does not have any content")}else console.error('ScrollBooster init error: "viewport" config property must be present and must be Element')}return a=d,b=[{key:"updateOptions",value:function(){var a=arguments.length>0&& void 0!==arguments[0]?arguments[0]:{};this.props=e(e({},this.props),a),this.props.onUpdate(this.getState()),this.startAnimationLoop()}},{key:"updateMetrics",value:function(){var a,b;this.viewport={width:this.props.viewport.clientWidth,height:this.props.viewport.clientHeight},this.content={width:Math.max((a=this.props.content).offsetWidth,a.scrollWidth),height:Math.max((b=this.props.content).offsetHeight,b.scrollHeight)},this.edgeX={from:Math.min(-this.content.width+this.viewport.width,0),to:0},this.edgeY={from:Math.min(-this.content.height+this.viewport.height,0),to:0},this.props.onUpdate(this.getState()),this.startAnimationLoop()}},{key:"startAnimationLoop",value:function(){var a=this;this.isRunning=!0,cancelAnimationFrame(this.rafID),this.rafID=requestAnimationFrame(function(){return a.animate()})}},{key:"animate",value:function(){var b=this;if(this.isRunning){this.updateScrollPosition(),this.isMoving()||(this.isRunning=!1,this.isTargetScroll=!1);var a=this.getState();this.setContentPosition(a),this.props.onUpdate(a),this.rafID=requestAnimationFrame(function(){return b.animate()})}}},{key:"updateScrollPosition",value:function(){this.applyEdgeForce(),this.applyDragForce(),this.applyScrollForce(),this.applyTargetForce();var a=1-this.props.friction;this.velocity.x*=a,this.velocity.y*=a,"vertical"!==this.props.direction&&(this.position.x+=this.velocity.x),"horizontal"!==this.props.direction&&(this.position.y+=this.velocity.y),this.props.bounce&&!this.isScrolling||this.isTargetScroll||(this.position.x=Math.max(Math.min(this.position.x,this.edgeX.to),this.edgeX.from),this.position.y=Math.max(Math.min(this.position.y,this.edgeY.to),this.edgeY.from))}},{key:"applyForce",value:function(a){this.velocity.x+=a.x,this.velocity.y+=a.y}},{key:"applyEdgeForce",value:function(){if(this.props.bounce&&!this.isDragging){var b=this.position.x<this.edgeX.from,d=this.position.x>this.edgeX.to,c=this.position.y<this.edgeY.from,e=this.position.y>this.edgeY.to,f=b||d,g=c||e;if(f||g){var l=b?this.edgeX.from:this.edgeX.to,m=c?this.edgeY.from:this.edgeY.to,h=l-this.position.x,i=m-this.position.y,a={x:h*this.props.bounceForce,y:i*this.props.bounceForce},j=this.position.x+(this.velocity.x+a.x)/this.props.friction,k=this.position.y+(this.velocity.y+a.y)/this.props.friction;(b&&j>=this.edgeX.from||d&&j<=this.edgeX.to)&&(a.x=h*this.props.bounceForce-this.velocity.x),(c&&k>=this.edgeY.from||e&&k<=this.edgeY.to)&&(a.y=i*this.props.bounceForce-this.velocity.y),this.applyForce({x:f?a.x:0,y:g?a.y:0})}}}},{key:"applyDragForce",value:function(){var a=100/(HR.Phone.settings.size.value+50);if(this.isDragging){var b=this.dragPosition.x*a-this.position.x,c=this.dragPosition.y*a-this.position.y;this.applyForce({x:b-this.velocity.x,y:c-this.velocity.y})}}},{key:"applyScrollForce",value:function(){this.isScrolling&&(this.applyForce({x:this.scrollOffset.x-this.velocity.x,y:this.scrollOffset.y-this.velocity.y}),this.scrollOffset.x=0,this.scrollOffset.y=0)}},{key:"applyTargetForce",value:function(){this.isTargetScroll&&this.applyForce({x:.08*(this.targetPosition.x-this.position.x)-this.velocity.x,y:.08*(this.targetPosition.y-this.position.y)-this.velocity.y})}},{key:"isMoving",value:function(){return this.isDragging||this.isScrolling||Math.abs(this.velocity.x)>=.01||Math.abs(this.velocity.y)>=.01}},{key:"scrollTo",value:function(){var a=arguments.length>0&& void 0!==arguments[0]?arguments[0]:{};this.isTargetScroll=!0,this.targetPosition.x=-a.x||0,this.targetPosition.y=-a.y||0,this.startAnimationLoop()}},{key:"setPosition",value:function(){var a=arguments.length>0&& void 0!==arguments[0]?arguments[0]:{};this.velocity.x=0,this.velocity.y=0,this.position.x=-a.x||0,this.position.y=-a.y||0,this.startAnimationLoop()}},{key:"getState",value:function(){return{isMoving:this.isMoving(),isDragging:!(!this.dragOffset.x&&!this.dragOffset.y),position:{x:-this.position.x,y:-this.position.y},dragOffset:this.dragOffset,dragAngle:this.getDragAngle(this.clientOffset.x,this.clientOffset.y),borderCollision:{left:this.position.x>=this.edgeX.to,right:this.position.x<=this.edgeX.from,top:this.position.y>=this.edgeY.to,bottom:this.position.y<=this.edgeY.from}}}},{key:"getDragAngle",value:function(a,b){return Math.round(Math.atan2(a,b)*(180/Math.PI))}},{key:"getDragDirection",value:function(a,b){return Math.abs(90-Math.abs(a))<=90-b?"horizontal":"vertical"}},{key:"setContentPosition",value:function(a){"transform"===this.props.scrollMode&&(this.props.content.style.transform="translate(".concat(-a.position.x,"px, ").concat(-a.position.y,"px)")),"native"===this.props.scrollMode&&(this.props.viewport.scrollTop=a.position.y,this.props.viewport.scrollLeft=a.position.x)}},{key:"handleEvents",value:function(){var a=this,b={x:0,y:0},c={x:0,y:0},d=null,e=null,f=!1,g=function(g){if(a.isDragging){var e=f?g.touches[0]:g,h=e.pageX,i=e.pageY,j=e.clientX,k=e.clientY;a.dragOffset.x=h-b.x,a.dragOffset.y=i-b.y,a.clientOffset.x=j-c.x,a.clientOffset.y=k-c.y,(Math.abs(a.clientOffset.x)>5&&!d||Math.abs(a.clientOffset.y)>5&&!d)&&(d=a.getDragDirection(a.getDragAngle(a.clientOffset.x,a.clientOffset.y),a.props.dragDirectionTolerance)),a.props.lockScrollOnDragDirection&&"all"!==a.props.lockScrollOnDragDirection?d===a.props.lockScrollOnDragDirection&&f?(a.dragPosition.x=a.dragStartPosition.x+a.dragOffset.x,a.dragPosition.y=a.dragStartPosition.y+a.dragOffset.y):f?(a.dragPosition.x=a.dragStartPosition.x,a.dragPosition.y=a.dragStartPosition.y):(a.dragPosition.x=a.dragStartPosition.x+a.dragOffset.x,a.dragPosition.y=a.dragStartPosition.y+a.dragOffset.y):(a.dragPosition.x=a.dragStartPosition.x+a.dragOffset.x,a.dragPosition.y=a.dragStartPosition.y+a.dragOffset.y)}};this.events.pointerdown=function(d){f=!(!d.touches||!d.touches[0]),a.props.onPointerDown(a.getState(),d,f);var h,j=f?d.touches[0]:d,n=j.pageX,o=j.pageY,k=j.clientX,l=j.clientY,i=a.props.viewport,m=i.getBoundingClientRect(),e=(HR.Phone.settings.size.value+50)/100;if(!(k-m.left*e>=i.clientLeft+i.clientWidth*e)&&!(l-m.top*e>=i.clientTop+i.clientHeight*e)&&a.props.shouldScroll(a.getState(),d)&&2!==d.button&&("mouse"!==a.props.pointerMode||!f)&&("touch"!==a.props.pointerMode||f)&&!(a.props.inputsFocus&&["input","textarea","button","select","label"].indexOf(d.target.nodeName.toLowerCase())> -1 || d.target.getAttribute("role")=="input")){if(a.props.textSelection){if(function(h,d,e){for(var f=h.childNodes,g=document.createRange(),b=0;b<f.length;b++){var c=f[b];if(3===c.nodeType){g.selectNodeContents(c);var a=g.getBoundingClientRect();if(d>=a.left&&e>=a.top&&d<=a.right&&e<=a.bottom)return c}}return!1}(d.target,k,l))return;(h=window.getSelection?window.getSelection():document.selection)&&(h.removeAllRanges?h.removeAllRanges():h.empty&&h.empty())}a.isDragging=!0,b.x=n,b.y=o,c.x=k,c.y=l,a.dragStartPosition.x=a.position.x*e,a.dragStartPosition.y=a.position.y*e,g(d),a.startAnimationLoop(),!f&&a.props.pointerDownPreventDefault&&d.preventDefault()}},this.events.pointermove=function(b){b.cancelable&&("all"===a.props.lockScrollOnDragDirection||a.props.lockScrollOnDragDirection===d)&&b.preventDefault(),g(b),a.props.onPointerMove(a.getState(),b,f)},this.events.pointerup=function(b){a.isDragging=!1,d=null,a.props.onPointerUp(a.getState(),b,f)},this.events.wheel=function(b){var c=a.getState();a.props.emulateScroll&&(a.velocity.x=0,a.velocity.y=0,a.isScrolling=!0,a.scrollOffset.x=-b.deltaX,a.scrollOffset.y=-b.deltaY,a.props.onWheel(c,b),a.startAnimationLoop(),clearTimeout(e),e=setTimeout(function(){return a.isScrolling=!1},80),a.props.preventDefaultOnEmulateScroll&&a.getDragDirection(a.getDragAngle(-b.deltaX,-b.deltaY),a.props.dragDirectionTolerance)===a.props.preventDefaultOnEmulateScroll&&b.preventDefault())},this.events.scroll=function(){var b=a.props.viewport,c=b.scrollLeft,d=b.scrollTop;Math.abs(a.position.x+c)>3&&(a.position.x=-c,a.velocity.x=0),Math.abs(a.position.y+d)>3&&(a.position.y=-d,a.velocity.y=0)},this.events.click=function(b){var c=a.getState(),d="vertical"!==a.props.direction?c.dragOffset.x:0,e="horizontal"!==a.props.direction?c.dragOffset.y:0;Math.max(Math.abs(d),Math.abs(e))>5&&(b.preventDefault(),b.stopPropagation()),a.props.onClick(c,b,f)},this.events.contentLoad=function(){return a.updateMetrics()},this.events.resize=function(){return a.updateMetrics()},this.props.viewport.addEventListener("mousedown",this.events.pointerdown),this.props.viewport.addEventListener("touchstart",this.events.pointerdown,{passive:!1}),this.props.viewport.addEventListener("click",this.events.click),this.props.viewport.addEventListener("wheel",this.events.wheel,{passive:!1}),this.props.viewport.addEventListener("scroll",this.events.scroll),this.props.content.addEventListener("load",this.events.contentLoad,!0),window.addEventListener("mousemove",this.events.pointermove),window.addEventListener("touchmove",this.events.pointermove,{passive:!1}),window.addEventListener("mouseup",this.events.pointerup),window.addEventListener("touchend",this.events.pointerup),window.addEventListener("resize",this.events.resize)}},{key:"destroy",value:function(){this.props.viewport.removeEventListener("mousedown",this.events.pointerdown),this.props.viewport.removeEventListener("touchstart",this.events.pointerdown),this.props.viewport.removeEventListener("click",this.events.click),this.props.viewport.removeEventListener("wheel",this.events.wheel),this.props.viewport.removeEventListener("scroll",this.events.scroll),this.props.content.removeEventListener("load",this.events.contentLoad),window.removeEventListener("mousemove",this.events.pointermove),window.removeEventListener("touchmove",this.events.pointermove),window.removeEventListener("mouseup",this.events.pointerup),window.removeEventListener("touchend",this.events.pointerup),window.removeEventListener("resize",this.events.resize)}}],g(a.prototype,b),c&&g(a,c),d}()}]).default})